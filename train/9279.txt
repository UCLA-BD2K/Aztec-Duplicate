The program sampletrees is a Markov chain Monte Carlo sampler of gene genealogies conditional on either phased or unphased SNP genotype data. The companion program Rsampletrees is for pre-and post-processing of sampletrees files, including setting up the files for sampletrees and storing and plotting the output of a sampletrees run. Availability and implementation: sampletrees is implemented in C Ã¾Ã¾. The source code, documentation and test files are available at http://stat.sfu.ca/statgen/research/sampletrees.html. The R package Rsampletrees is available on CRAN http://cran.r-project.org/web/packages/ Rsampletrees/index.html.