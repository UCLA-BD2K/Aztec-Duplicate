updated version of the tool factory 