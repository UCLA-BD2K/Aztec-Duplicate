Preprocessing and analysis for single microarrays and microarray batches.